{"version":3,"sources":["chrome_driver_extension.js","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/10"],"names":[],"mappings":"AAAA;AAAA,KAAO,EAAE,IAAG,CAAE,KAAO,cAAY,CAAC;AAClC,KAAO,EAAE,WAAU;AAAG,iBAAe;AAAG,UAAQ,CAAE,KAAO,iCAA+B,CAAC;AACzF,KAAO,EACL,IAAG;AAAG,UAAQ;AAAG,QAAM;AAAG,cAAY;AAAG,cAAY;AAAG,cAAY;AAAG,cAAY,CACrF,KAAO,2BAAyB,CAAC;AAEjC,KAAO,EAAE,kBAAiB,CAAE,KAAO,0BAAwB,CAAC;AAC5D,KAAO,EAAE,gBAAe,CAAE,KAAO,wBAAsB,CAAC;AACxD,KAAO,EAAE,OAAM,CAAE,KAAO,4BAA0B,CAAC;AAGnD,KAAO,MAAM,sBAAoB,QAAU,mBAAiB;AAE1D,WAAW,SAAO,EAAI;AAAE,SAAO,UAAQ,CAAC;EAAE;AAAA,AAI1C,YAAU,CAAE,MAAK,AAAiB,CAAG;ACjBvC,SAAK,cAAc,QDiBE,iBAAe,CCjBE,CAAA;ADkBlC,QAAI,AAAC,EAAC,CAAC;AACP,OAAG,QAAQ,EAAI,OAAK,CAAC;EACvB;AAAA,AAEA,GAAC,CAAE,AAAD,CAAG;AACH,SAAO,CAAA,IAAG,QAAQ,cAAc,AAAC,CAAC,aAAY,CAAC,CAAC;EAClD;AAAA,AAEA,UAAQ,CAAE,IAAG,AAAO;AC1BtB,SAAK,cAAc,MCAnB,CAAA,MAAK,KAAK,QDA4B,CAAA;AEAtC,SAAO,CAAA,MAAK,WAAW,AAAC,CAAC,CH2Bd,IAAG,QAAQ,cAAc,AAAC,CAAC,iBAAiB,IAAG,KAAK,CAAC,CG3BrB,CH0BlB,QAAM,CG1BgC,CAAA;EH4B7D;AAEA,QAAM,CAAE,IAAG,AAAO,CAAG,CAAA,WAAU,EAAW,KAAG;AC9B/C,SAAK,cAAc,MCAnB,CAAA,MAAK,KAAK,qBAAV,CAAA,MAAK,KAAK,QDA4B,CAAA;AD+BlC,AAAI,MAAA,CAAA,MAAK,EAAI,qBAAoB,IAAG,KAAK,CAAC;AAC1C,OAAI,SAAQ,AAAC,CAAC,WAAU,CAAC,CAAG;AAC1B,WAAK,GAAK,kBAAiB,WAAU,KAAK,CAAA;IAC5C;AAAA,AGlCJ,SAAO,CAAA,MAAK,WAAW,AAAC,CAAC,CHmCd,IAAG,QAAQ,cAAc,AAAC,CAAC,MAAK,CAAC,CGnCD,CH8BO,QAAM,CG9BO,CAAA;EHoC7D;AAGA,YAAU,CAAE,AAAD,CAAG;AAGZ,SAAO,CAAA,IAAG,QAAQ,cAAc,AAAC,CAAC,KAAI,CAAC,KACjC,AAAC,CAAE,CAAC,CAAA,IAAM,CAAA,IAAG,QAAQ,KAAK,AAAC,CAAC,aAAY,CAAC,CAAE,KAC3C,AAAC,CAAE,CAAC,OAAM,IAAM;AAClB,AAAI,QAAA,CAAA,MAAK,EAAI,GAAC,CAAC;AACf,gBAAU,QAAQ,AAAC,CAAC,OAAM,CAAG,UAAS,KAAI,CAAG;AAC3C,AAAI,UAAA,CAAA,OAAM,EAAI,CAAA,IAAG,MAAM,AAAC,CAAC,KAAI,CAAE,SAAQ,CAAC,CAAC,CAAE,SAAQ,CAAC,CAAC;AACrD,WAAI,aAAY,OAAO,AAAC,CAAC,OAAM,CAAE,QAAO,CAAC,CAAG,wBAAsB,CAAC,CAAG;AACpE,oBAAU,KAAK,AAAC,CAAC,MAAK,CAAG,CAAA,OAAM,CAAE,QAAO,CAAC,CAAC,CAAC;QAC7C;AAAA,AACA,WAAI,aAAY,OAAO,AAAC,CAAC,OAAM,CAAE,QAAO,CAAC,CAAG,sBAAoB,CAAC,CAAG;AAClE,cAAM,IAAI,cAAY,AAAC,CAAC,mDAAkD,CAAC,CAAC;QAC9E;AAAA,MACF,CAAC,CAAC;AACF,WAAO,CAAA,IAAG,4BAA4B,AAAC,CAAC,MAAK,CAAC,CAAC;IACjD,CAAC,CAAC;EACN;AAAA,AAEA,4BAA0B,CAAE,YAAW,CAAG,CAAA,gBAAe,EAAI,KAAG,CAAG;AACjE,OAAI,OAAM,AAAC,CAAC,gBAAe,CAAC,CAAG;AAC7B,qBAAe,EAAI,GAAC,CAAC;IACvB;AAAA,AACA,eAAW,QAAQ,AAAC,CAAE,CAAC,KAAI,IAAM;AAC/B,AAAI,QAAA,CAAA,GAAE,EAAI,CAAA,KAAI,CAAE,KAAI,CAAC,CAAC;AACtB,AAAI,QAAA,CAAA,IAAG,EAAI,CAAA,KAAI,CAAE,MAAK,CAAC,CAAC;AACxB,AAAI,QAAA,CAAA,IAAG,EAAI,CAAA,KAAI,CAAE,MAAK,CAAC,CAAC;AACxB,SAAI,aAAY,OAAO,AAAC,CAAC,GAAE,CAAG,wCAAsC,CAAC,CAAG;AACtE,WAAI,aAAY,OAAO,AAAC,CAAC,IAAG,CAAG,eAAa,CAAC,CAAA,EAC3C,EAAC,OAAM,AAAC,CAAC,IAAG,CAAC,CAAA,EAAK,CAAA,OAAM,AAAC,CAAC,IAAG,CAAE,MAAK,CAAC,CAAC,CAAA,EAAK,EAAC,aAAY,OAAO,AAAC,CAAC,IAAG,CAAE,MAAK,CAAC,CAAE,YAAW,CAAC,CAAG,iBAAe,CAAC,CAAC,CAAG;AACjH,oBAAU,KAAK,AAAC,CAAC,gBAAe,CAAG,CAAA,cAAa,AAAC,CAAC,KAAI,CAAG,EACvD,MAAK,CAAG,SAAO,CACjB,CAAC,CAAC,CAAC;QACL,KAAO,KAAI,aAAY,OAAO,AAAC,CAAC,IAAG,CAAG,oBAAkB,CAAC,CAAA,EACvD,CAAA,aAAY,OAAO,AAAC,CAAC,IAAG,CAAG,SAAO,CAAC,CAAA,EACnC,CAAA,aAAY,OAAO,AAAC,CAAC,IAAG,CAAG,kBAAgB,CAAC,CAAA,EAC5C,CAAA,aAAY,OAAO,AAAC,CAAC,IAAG,CAAG,QAAM,CAAC,CAAA,EAClC,CAAA,aAAY,OAAO,AAAC,CAAC,IAAG,CAAG,YAAU,CAAC,CAAA,EACtC,CAAA,aAAY,OAAO,AAAC,CAAC,IAAG,CAAG,kBAAgB,CAAC,CAAG;AAC/C,oBAAU,KAAK,AAAC,CAAC,gBAAe,CAAG,CAAA,cAAa,AAAC,CAAC,KAAI,CAAG,EACvD,MAAK,CAAG,SAAO,CACjB,CAAC,CAAC,CAAC;QACL,KAAO,KAAI,aAAY,OAAO,AAAC,CAAC,IAAG,CAAG,UAAQ,CAAC,CAAG;AAChD,oBAAU,KAAK,AAAC,CAAC,gBAAe,CAAG,CAAA,cAAa,AAAC,CAAC,KAAI,CAAG;AACvD,iBAAK,CAAG,KAAG;AACX,iBAAK,CAAG,EACN,cAAa,CAAG,CAAA,SAAQ,AAAC,CAAC,IAAG,CAAE,mBAAkB,CAAC,CAAC,CAAA,CAAI,CAAA,IAAG,CAAE,mBAAkB,CAAC,EAAI,CAAA,IAAG,CAAE,oBAAmB,CAAC,CAC9G;AAAA,UACF,CAAC,CAAC,CAAC;QACL;AAAA,MACF,KAAO,KAAI,aAAY,OAAO,AAAC,CAAC,GAAE,CAAG,gBAAc,CAAC,CAAG;AACrD,kBAAU,KAAK,AAAC,CAAC,gBAAe,CAAG,CAAA,cAAa,AAAC,CAAC,KAAI,CAAG,EACvD,MAAK,CAAG,KAAG,CACb,CAAC,CAAC,CAAC;MACL;AAAA,IACF,CAAC,CAAC;AACF,SAAO,iBAAe,CAAC;EACzB;AAAA,AAEA,SAAO,CAAE,YAAW,AAAU;ACnGhC,SAAK,cAAc,cDmGK,UAAQ,CCnGM,CAAA;AEAtC,SAAO,CAAA,MAAK,WAAW,AAAC,CAAC,CHoGd,aAAY,OAAO,AAAC,CAAC,YAAW,CAAE,aAAY,CAAC,YAAY,AAAC,EAAC,CAAG,SAAO,CAAC,CGpGxC,CDA3C,CAAA,MAAK,KAAK,SCAqD,CAAA;EHqG7D;AACF;AAAA,AItGA,KAAK,eAAe,AAAC,qCACb,EAAC,GAAE,CAAG,UAAS,AAAD,CAAG;AAAC,YJgBL,gBAAe,GIhBa;EAAC,CAAC,CAAC,CAAC;AADrD,KAAK,eAAe,AAAC,yDACb,EAAC,GAAE,CAAG,UAAS,AAAD,CAAG;AAAC,YFD1B,MAAK,KAAK,UECuC;EAAC,CAAC,CAAC,CAAC;AADrD,KAAK,eAAe,AAAC,uDACb,EAAC,GAAE,CAAG,UAAS,AAAD,CAAG;AAAC,YFD1B,MAAK,KAAK,WAAV,MAAK,KAAK,UECuC;EAAC,CAAC,CAAC,CAAC;AADrD,KAAK,eAAe,AAAC,wDACb,EAAC,GAAE,CAAG,UAAS,AAAD,CAAG;AAAC,YJkGF,SAAQ,GIlGiB;EAAC,CAAC,CAAC,CAAC;AJuGrD,OAAS,eAAa,CAAE,WAAU,CAAG,CAAA,IAAG,CAAG;AACzC,AAAI,IAAA,CAAA,EAAC,EAAI,CAAA,WAAU,CAAE,IAAG,CAAC,CAAC;AAC1B,KAAI,aAAY,OAAO,AAAC,CAAC,EAAC,CAAG,IAAE,CAAC,CAAG;AACjC,KAAC,EAAI,IAAE,CAAC;EACV,KAAO,KAAI,aAAY,OAAO,AAAC,CAAC,EAAC,CAAG,IAAE,CAAC,CAAG;AACxC,KAAC,EAAI,IAAE,CAAC;EACV;AAAA,AACI,IAAA,CAAA,MAAK,EAAI;AACX,QAAI,CAAG,CAAA,WAAU,CAAE,KAAI,CAAC;AACxB,OAAG,CAAG,GAAC;AACP,QAAI,CAAG,WAAS;AAChB,OAAG,CAAG,CAAA,WAAU,CAAE,IAAG,CAAC,EAAI,KAAG;AAAA,EAC/B,CAAC;AACD,KAAI,WAAU,CAAE,IAAG,CAAC,IAAM,IAAE,CAAG;AAC7B,AAAI,MAAA,CAAA,GAAE,EAAI,CAAA,WAAU,CAAE,KAAI,CAAC,CAAC;AAC5B,OAAI,OAAM,AAAC,CAAC,GAAE,CAAC,CAAG;AAChB,QAAE,EAAI,CAAA,WAAU,CAAE,MAAK,CAAC,CAAC;IAC3B;AAAA,AACA,SAAK,CAAE,KAAI,CAAC,EAAI,CAAA,OAAM,AAAC,CAAC,GAAE,CAAC,CAAA,CAAI,IAAE,EAAI,CAAA,GAAE,EAAI,KAAG,CAAC;EACjD;AAAA,AACA,iBAAe,QAAQ,AAAC,CAAC,IAAG,CAAG,EAAC,KAAI,CAAG,CAAA,IAAG,IAAM;AAC9C,SAAK,CAAE,IAAG,CAAC,EAAI,MAAI,CAAC;EACtB,CAAC,CAAC;AACF,OAAO,OAAK,CAAC;AACf;AAAA,AAEI,EAAA,CAAA,SAAQ,EAAI,EACd,IAAG,AAAC,CAAC,qBAAoB,CAAC,UAAU,AAAC,CACnC,CAAC,MAAK,IAAM,IAAI,sBAAoB,AAAC,CAAC,MAAK,CAAC,CAC5C,EAAC,gBAAe,CAAC,CACnB,CACF,CAAC;AAAA","file":"/Users/patrick/Documents/open source/angular/modules/benchpress/src/webdriver/chrome_driver_extension.js","sourceRoot":"/Users/patrick/Documents/open source/angular/modules/benchpress/src/webdriver/","sourcesContent":["import { bind } from 'angular2/di';\nimport { ListWrapper, StringMapWrapper, StringMap } from 'angular2/src/facade/collection';\nimport {\n  Json, isPresent, isBlank, RegExpWrapper, StringWrapper, BaseException, NumberWrapper\n} from 'angular2/src/facade/lang';\n\nimport { WebDriverExtension } from '../web_driver_extension';\nimport { WebDriverAdapter } from '../web_driver_adapter';\nimport { Promise } from 'angular2/src/facade/async';\n\n\nexport class ChromeDriverExtension extends WebDriverExtension {\n  // TODO(tbosch): use static values when our transpiler supports them\n  static get BINDINGS() { return _BINDINGS; }\n\n  _driver:WebDriverAdapter;\n\n  constructor(driver:WebDriverAdapter) {\n    super();\n    this._driver = driver;\n  }\n\n  gc() {\n    return this._driver.executeScript('window.gc()');\n  }\n\n  timeBegin(name:string):Promise {\n    return this._driver.executeScript(`console.time('${name}');`);\n  }\n\n  timeEnd(name:string, restartName:string = null):Promise {\n    var script = `console.timeEnd('${name}');`;\n    if (isPresent(restartName)) {\n      script += `console.time('${restartName}');`\n    }\n    return this._driver.executeScript(script);\n  }\n\n  // See [Chrome Trace Event Format](https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/edit)\n  readPerfLog() {\n    // TODO(tbosch): Bug in ChromeDriver: Need to execute at least one command\n    // so that the browser logs can be read out!\n    return this._driver.executeScript('1+1')\n      .then( (_) => this._driver.logs('performance') )\n      .then( (entries) => {\n        var events = [];\n        ListWrapper.forEach(entries, function(entry) {\n          var message = Json.parse(entry['message'])['message'];\n          if (StringWrapper.equals(message['method'], 'Tracing.dataCollected')) {\n            ListWrapper.push(events, message['params']);\n          }\n          if (StringWrapper.equals(message['method'], 'Tracing.bufferUsage')) {\n            throw new BaseException('The DevTools trace buffer filled during the test!');\n          }\n        });\n        return this._convertPerfRecordsToEvents(events);\n      });\n  }\n\n  _convertPerfRecordsToEvents(chromeEvents, normalizedEvents = null) {\n    if (isBlank(normalizedEvents)) {\n      normalizedEvents = [];\n    }\n    chromeEvents.forEach( (event) => {\n      var cat = event['cat'];\n      var name = event['name'];\n      var args = event['args'];\n      if (StringWrapper.equals(cat, 'disabled-by-default-devtools.timeline')) {\n        if (StringWrapper.equals(name, 'FunctionCall') &&\n          (isBlank(args) || isBlank(args['data']) || !StringWrapper.equals(args['data']['scriptName'], 'InjectedScript'))) {\n          ListWrapper.push(normalizedEvents, normalizeEvent(event, {\n            'name': 'script'\n          }));\n        } else if (StringWrapper.equals(name, 'RecalculateStyles') ||\n          StringWrapper.equals(name, 'Layout') ||\n          StringWrapper.equals(name, 'UpdateLayerTree') ||\n          StringWrapper.equals(name, 'Paint') ||\n          StringWrapper.equals(name, 'Rasterize') ||\n          StringWrapper.equals(name, 'CompositeLayers')) {\n          ListWrapper.push(normalizedEvents, normalizeEvent(event, {\n            'name': 'render'\n          }));\n        } else if (StringWrapper.equals(name, 'GCEvent')) {\n          ListWrapper.push(normalizedEvents, normalizeEvent(event, {\n            'name': 'gc',\n            'args': {\n              'usedHeapSize': isPresent(args['usedHeapSizeAfter']) ? args['usedHeapSizeAfter'] : args['usedHeapSizeBefore']\n            }\n          }));\n        }\n      } else if (StringWrapper.equals(cat, 'blink.console')) {\n        ListWrapper.push(normalizedEvents, normalizeEvent(event, {\n          'name': name\n        }));\n      }\n    });\n    return normalizedEvents;\n  }\n\n  supports(capabilities:StringMap):boolean {\n    return StringWrapper.equals(capabilities['browserName'].toLowerCase(), 'chrome');\n  }\n}\n\nfunction normalizeEvent(chromeEvent, data) {\n  var ph = chromeEvent['ph'];\n  if (StringWrapper.equals(ph, 'S')) {\n    ph = 'b';\n  } else if (StringWrapper.equals(ph, 'F')) {\n    ph = 'e';\n  }\n  var result = {\n    'pid': chromeEvent['pid'],\n    'ph': ph,\n    'cat': 'timeline',\n    'ts': chromeEvent['ts'] / 1000\n  };\n  if (chromeEvent['ph'] === 'X') {\n    var dur = chromeEvent['dur'];\n    if (isBlank(dur)) {\n      dur = chromeEvent['tdur'];\n    }\n    result['dur'] = isBlank(dur) ? 0.0 : dur / 1000;\n  }\n  StringMapWrapper.forEach(data, (value, prop) => {\n    result[prop] = value;\n  });\n  return result;\n}\n\nvar _BINDINGS = [\n  bind(ChromeDriverExtension).toFactory(\n    (driver) => new ChromeDriverExtension(driver),\n    [WebDriverAdapter]\n  )\n];","assert.argumentTypes($__placeholder__0)","assert.type.$__placeholder__0)","return assert.returnType(($__placeholder__0), $__placeholder__1)","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});"]}